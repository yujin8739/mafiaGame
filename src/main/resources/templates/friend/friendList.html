<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¹œêµ¬ ëª©ë¡ - GodFather 0805</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link rel="stylesheet" th:href="@{/css/common/header.css}" />
    <link rel="stylesheet" th:href="@{/css/common/footer.css}" />
    <link rel="stylesheet" th:href="@{/css/member/mypage.css}" />
    <link rel="icon" href="/favicon.ico">
    <link rel="stylesheet" th:href="@{/css/message/friendList.css}" />
    

</head>
<body>
<body>

    <!-- í—¤ë” -->
    <div th:replace="~{common/header :: header}"></div>

    <!-- ì¹œêµ¬ ëª©ë¡ ì»¨í…Œì´ë„ˆ -->
    <div class="friend-container">
        <h1 class="mypage-title">ğŸ‘¥ ì¹œêµ¬ ëª©ë¡</h1>

        <!-- ì¹œêµ¬ ê²€ìƒ‰ -->
        <div class="friend-search">
            <input type="text" id="searchInput" placeholder="ì¹œêµ¬ ê²€ìƒ‰...">
            <button class="mypage-btn primary" onclick="searchFriends()">ê²€ìƒ‰</button>
            <button class="mypage-btn" onclick="addFriend()">ì¹œêµ¬ ì¶”ê°€</button>
        </div>

        <!-- ì¹œêµ¬ ëª©ë¡ -->
        <div class="profile-section">
            <h3>ë‚´ ì¹œêµ¬ë“¤</h3>
            
            <!-- TODO: ì‹¤ì œ ì¹œêµ¬ ë°ì´í„°ê°€ ìˆì„ ë•Œ -->
            <!-- 
            <div th:if="${friends != null and !#lists.isEmpty(friends)}" class="friend-list">
                <div th:each="friend : ${friends}" class="friend-card">
                    <div class="friend-info">
                        <div class="friend-avatar" th:text="${friend.nickName?.substring(0, 1)}">A</div>
                        <div class="friend-details">
                            <h4 th:text="${friend.nickName}">ì¹œêµ¬ ë‹‰ë„¤ì„</h4>
                            <p th:text="'@' + ${friend.userName}">@username</p>
                            <span class="online-status" 
                                  th:classappend="${friend.isOnline} ? 'online' : 'offline'"></span>
                            <span th:text="${friend.isOnline} ? 'ì˜¨ë¼ì¸' : 'ì˜¤í”„ë¼ì¸'">ìƒíƒœ</span>
                        </div>
                    </div>
                    <div class="friend-actions">
                        <button class="friend-btn message-btn" 
                                th:onclick="|sendMessage('${friend.userName}')|">ìª½ì§€ë³´ë‚´ê¸°</button>
                        <button class="friend-btn remove-btn" 
                                th:onclick="|removeFriend('${friend.userName}')|">ì¹œêµ¬ì‚­ì œ</button>
                    </div>
                </div>
            </div>
            -->
            
            <!-- ì„ì‹œ ë°ëª¨ ë°ì´í„° -->
            <div class="friend-list">
                <div class="friend-card">
                    <div class="friend-info">
                        <div class="friend-avatar">A</div>
                        <div class="friend-details">
                            <h4>Alice</h4>
                            <p>@alice123</p>
                            <span class="online-status online"></span>
                            <span>ì˜¨ë¼ì¸</span>
                        </div>
                    </div>
                    <div class="friend-actions">
                        <button class="friend-btn message-btn" onclick="sendMessage('alice123')">ìª½ì§€ë³´ë‚´ê¸°</button>
                        <button class="friend-btn remove-btn" onclick="removeFriend('alice123')">ì¹œêµ¬ì‚­ì œ</button>
                    </div>
                </div>
                
                <div class="friend-card">
                    <div class="friend-info">
                        <div class="friend-avatar">B</div>
                        <div class="friend-details">
                            <h4>Bob</h4>
                            <p>@bob456</p>
                            <span class="online-status offline"></span>
                            <span>ì˜¤í”„ë¼ì¸</span>
                        </div>
                    </div>
                    <div class="friend-actions">
                        <button class="friend-btn message-btn" onclick="sendMessage('bob456')">ìª½ì§€ë³´ë‚´ê¸°</button>
                        <button class="friend-btn remove-btn" onclick="removeFriend('bob456')">ì¹œêµ¬ì‚­ì œ</button>
                    </div>
                </div>
            </div>
            
            <!-- ì¹œêµ¬ê°€ ì—†ì„ ë•Œ
            <div th:if="${friends == null or #lists.isEmpty(friends)}" class="no-friends">
                <p>ì•„ì§ ì¶”ê°€ëœ ì¹œêµ¬ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
                <p>ì¹œêµ¬ë¥¼ ì¶”ê°€í•´ë³´ì„¸ìš”!</p>
            </div>
            -->
        </div>

        <!-- ì•¡ì…˜ ë²„íŠ¼ë“¤ -->
        <div class="action-buttons">
            <a href="/message/inbox" class="mypage-btn primary">ìª½ì§€í•¨</a>
            <a href="/mypage" class="mypage-btn">ë§ˆì´í˜ì´ì§€ë¡œ</a>
        </div>
    </div>

    <!-- í‘¸í„° -->
    <div th:replace="~{common/footer :: footer}"></div>

    <script>
        // ì¹œêµ¬ì—ê²Œ ìª½ì§€ ë³´ë‚´ê¸°
        function sendMessage(userName) {
            const url = '/message/write?receiverUserName=' + encodeURIComponent(userName);
            location.href = url;
        }

        // ì¹œêµ¬ ì‚­ì œ
        function removeFriend(userName) {
            if (confirm(userName + 'ë‹˜ì„ ì¹œêµ¬ ëª©ë¡ì—ì„œ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                // TODO: ì‹¤ì œ ì¹œêµ¬ ì‚­ì œ API êµ¬í˜„
                $.ajax({
                    url: '/friend/remove',
                    type: 'POST',
                    data: { friendUserName: userName },
                    success: function(response) {
                        if (response.success) {
                            alert('ì¹œêµ¬ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
                            location.reload();
                        } else {
                            alert(response.message || 'ì¹œêµ¬ ì‚­ì œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                        }
                    },
                    error: function() {
                        alert('ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                    }
                });
            }
        }

        // ì¹œêµ¬ ì¶”ê°€
        function addFriend() {
            const userName = prompt('ì¶”ê°€í•  ì¹œêµ¬ì˜ ì‚¬ìš©ìëª…ì„ ì…ë ¥í•˜ì„¸ìš”:');
            if (userName && userName.trim()) {
                // TODO: ì‹¤ì œ ì¹œêµ¬ ì¶”ê°€ API êµ¬í˜„
                $.ajax({
                    url: '/friend/add',
                    type: 'POST',
                    data: { friendUserName: userName.trim() },
                    success: function(response) {
                        if (response.success) {
                            alert('ì¹œêµ¬ ìš”ì²­ì„ ë³´ëƒˆìŠµë‹ˆë‹¤.');
                            location.reload();
                        } else {
                            alert(response.message || 'ì¹œêµ¬ ì¶”ê°€ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                        }
                    },
                    error: function() {
                        alert('ì„œë²„ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                    }
                });
            }
        }

        // ì¹œêµ¬ ê²€ìƒ‰
        function searchFriends() {
            const searchTerm = document.getElementById('searchInput').value.trim();
            if (!searchTerm) {
                location.reload();
                return;
            }
            
            // TODO: ì‹¤ì œ ê²€ìƒ‰ API êµ¬í˜„
            console.log('ì¹œêµ¬ ê²€ìƒ‰:', searchTerm);
            alert('ê²€ìƒ‰ ê¸°ëŠ¥ì€ ê°œë°œ ì¤‘ì…ë‹ˆë‹¤.');
        }

        // ì—”í„°í‚¤ë¡œ ê²€ìƒ‰
        document.getElementById('searchInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                searchFriends();
            }
        });

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì‹¤í–‰
        $(document).ready(function() {
            console.log('ì¹œêµ¬ ëª©ë¡ í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ');
        });
    </script>

</body>
</html> 