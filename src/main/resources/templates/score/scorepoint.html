<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<title>ìš°ì£¼í•˜ë§ˆí”¼ì•„ ê²Œì„ ì „ì </title>

<!-- ê¸°ì¡´ ê³µí†µ CSS ìœ ì§€ -->
<link rel="stylesheet" th:href="@{/css/common/header.css}" />
<link rel="stylesheet" th:href="@{/css/common/footer.css}" />
<link rel="stylesheet" th:href="@{/css/friend/friendList.css}" />
<link rel="stylesheet" th:href="@{/css/score/score.css}" />


<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>

<body>
	<div th:replace="~{common/header :: header}"></div>

	<main class="score-main-container">
		<h1 class="score-title">ğŸŒŒ ë‚˜ì˜ ì „ì  í™•ì¸</h1>
		<div id="score-record-list" class="score-record-list"></div>
		<div id="score-pagination" class="score-pagination"></div>
	</main>

	<div th:replace="~{common/footer :: footer}"></div>

	<script th:inline="javascript">
    let userName = /*[[${loginUser.userName}]]*/ '';
    let currentPage = 1;
    let maxPage = 1; // ìµœëŒ€ í˜ì´ì§€ ìˆ˜ ì €ì¥

    function loadRecodeList(page) {
        currentPage = page;
        $.ajax({
            url: "/score/recodeList",
            data: { userName, currentPage },
            success: function (resultMap) {
                const container = document.getElementById("score-record-list");
                container.innerHTML = "";

                // ì „ì  ë¦¬ìŠ¤íŠ¸ ë Œë”ë§
                resultMap.recodeList.forEach(recode => {
                    const card = document.createElement("div");
                    card.className = "score-card";
                    card.innerHTML = `
                        <div class="score-team">${recode.TEAM}</div>
                        <div class="score-job">${recode.JOBVISIBLE}</div>
                        <div class="score-result">${recode.TEAMRESULT}</div>
                    `;
                    container.appendChild(card);
                });

                // ì´ í˜ì´ì§€ ìˆ˜ ì—…ë°ì´íŠ¸
                maxPage = resultMap.maxPage;
                renderPagination();
            },
            error: function () {
                alert("ì „ì  ë¡œë”© ì‹¤íŒ¨");
            }
        });
    }

    function renderPagination() {
        const pagination = document.getElementById("score-pagination");
        pagination.innerHTML = "";

        const prev = document.createElement("button");
        prev.textContent = "Â« ì´ì „";
        prev.disabled = currentPage === 1;
        prev.onclick = () => loadRecodeList(currentPage - 1);

        const next = document.createElement("button");
        next.textContent = "ë‹¤ìŒ Â»";
        next.disabled = currentPage >= maxPage; // ì œí•œ ì¶”ê°€
        next.onclick = () => loadRecodeList(currentPage + 1);

        const pageInfo = document.createElement("span");
        pageInfo.textContent = `í˜ì´ì§€ ${currentPage} / ${maxPage}`;
        pageInfo.className = "score-page-info";

        pagination.append(prev, pageInfo, next);
    }

    loadRecodeList(1);

    </script>
</body>
</html>
