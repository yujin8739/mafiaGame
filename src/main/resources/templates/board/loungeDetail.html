<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>게시글 상세보기</title>

<!-- Bootstrap -->
<link rel="stylesheet"
	href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/css/bootstrap.min.css" />
<!-- font-awesome -->
<link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<link rel="stylesheet" th:href="@{/css/common/header.css}" />
<link rel="stylesheet" th:href="@{/css/common/footer.css}" />
<link rel="stylesheet" th:href="@{/css/friend/friendList.css}" />
<link rel="stylesheet" th:href="@{/css/board/loungeDetail.css}" />

</head>
<body>

	<!-- 헤더 -->
	<div th:replace="~{common/header :: header}"></div>

	<div class="board-wrapper">
		<div class="card">
			<div class="card-header" th:text="${board.title}">게시글 제목</div>
			<div class="card-body">

				<div class="meta-info">
					<span style="display: flex; align-items: center; gap: 8px;">
						<img th:src="@{${board.profileUrl}}" alt="Badge"
						class="profileImg" /> <strong th:text="${board.nickName}">작성자</strong>
					</span> <span style="display: flex; align-items: center; gap: 12px;">작성일:
						<span th:text="${board.createDate}">2025-07-04</span>
					</span> <span style="display: flex; align-items: center; gap: 12px;">조회수:
						<span th:text="${board.viewCount}">80</span>
					</span>
				</div>


				<th:block th:if="${board.fileList[0].status == 'Y'}">
					<div class="attachments" th:if="${board.fileList[0].fileNo != 0}">
						<hr />
						<h6>📎 첨부파일</h6>
						<div class="attachment-list">
							<div class="attachment-item" th:object="${board.fileList[0]}">
								<i class="fas fa-paperclip"></i> <a
									th:href="@{/godDaddy_uploadImage/loungeImage/{fileName}(fileName=*{changeName})}"
									th:text="*{originName}" th:download="*{originName}"></a>
							</div>
						</div>
					</div>
				</th:block>

				<hr />


				<div th:utext="${board.detail}">게시글 내용 출력 부분 (HTML 포함 가능)</div>


				<!-- ✅ 게시글 좋아요/싫어요 버튼: 본문 바로 아래에 위치 -->
				<div
					class="post-like-dislike d-flex justify-content-center align-items-center"
					style="gap: 15px; margin: 30px 0;">
					<button id="btnLike" type="button"
						class="btn btn-outline-danger d-flex align-items-center"
						style="gap: 6px;">
						<i class="fas fa-heart"></i> 좋아요 <span id="likeCount"
							th:text="${board.likeCount}">0</span>
					</button>
					<button id="btnDislike" type="button"
						class="btn btn-outline-primary d-flex align-items-center"
						style="gap: 6px;">
						<i class="fas fa-thumbs-down"></i> 싫어요 <span id="dislikeCount"
							th:text="${board.dislikeCount}">0</span>
					</button>
				</div>





				<div class="btn-group-custom">
					<a onclick="history.go(-1)" class="btn btn-custom btn-list">목록으로</a>
					<th:block th:if="${loginUser.userName == board.userName}">
						<a
							th:href="@{/board/lounge/update/{boardNo}(boardNo=${board.boardNo})}"
							class="btn btn-custom btn-update">수정</a>
					</th:block>
					<th:block th:if="${loginUser.userName == board.userName}">
						<form
							th:action="@{/board/lounge/delete/{boardNo}(boardNo=${board.boardNo})}"
							method="POST">
							<button class="btn btn-custom btn-delete"
								onclick="return confirm('정말로 삭제하시겠습니까?')">삭제</button>
						</form>
					</th:block>
				</div>


				<!-- 댓글 영역 -->
				<div class="comments-section">
					<hr />
					<!-- ✅ BEST 댓글 영역 -->
					<div class="best-comments-section" style="margin-top: 40px;">
					  <h6>🔥 베스트 댓글</h6>
					  <div id="bestCommentList" class="comment-list"></div>
					  <hr />
					</div>
					
					
					<h6>💬 댓글</h6>

					<!-- 댓글 목록 -->
					<div id="commentList" class="comment-list">
						<!-- 비동기로 불러온 댓글이 여기에 삽입될 예정 -->
					</div>

					<!-- 댓글 작성 폼 -->
					<div class="comment-form mt-3">
						<textarea class="form-control" id="commentContent" rows="3"
							placeholder="댓글을 입력하세요..."></textarea>
						<!-- 이미지 파일 업로드 추가 -->
						<div class="mt-2">
							<input type="file" id="commentImage" accept="image/*"
								class="form-control-file text-light">
						</div>
						<img id="previewImage"
							style="max-width: 100px; margin-top: 10px; display: none;" />

						<div class="text-right mt-2">
							<button class="btn btn-primary btn-sm" id="submitComment">등록</button>
						</div>

					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- 댓글 불러오기/등록 JS -->
	<script th:inline="javascript">
		const boardNo = /*[[${board.boardNo}]]*/ 0;
		const userName = /*[[${loginUser.userName}]]*/ '';
	</script>
	<script th:src="@{/js/board/comment.js}" th:inline="javascript"></script>
	<script th:src="@{/js/board/postLike.js}" th:inline="javascript"></script>

	<!-- 푸터 -->
	<div th:replace="~{common/footer :: footer}"></div>

</body>
</html>
