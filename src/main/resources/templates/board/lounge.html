<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ììœ ê²Œì‹œíŒ</title>

  <!-- Bootstrap 4.5.2 + jQuery -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/css/bootstrap.min.css" />
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

  <!-- ê³µí†µ CSS -->
  <link rel="stylesheet" th:href="@{/css/common/header.css}" />
  <link rel="stylesheet" th:href="@{/css/common/footer.css}" />

  <style>
    body {
      background-color: #0b0b0b;
      font-family: 'Noto Sans KR', sans-serif;
      padding: 40px 8%;
      color: #fff;
    }

    .board-wrapper {
      background-color: #fff;
      color: #333;
      border-radius: 12px;
      padding: 30px;
      box-shadow: 0 0 20px rgba(255, 255, 255, 0.05);
    }

    .main-tabs a {
      font-weight: bold;
      color: #999;
      text-decoration: none;
      margin-right: 24px;
      font-size: 18px;
      border-bottom: 3px solid transparent;
      padding-bottom: 5px;
    }

    .main-tabs a.active {
      color: #c82e38;
      border-color: #c82e38;
    }

    .sub-tabs, .team-tabs, .role-tabs {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      margin: 20px 0;
    }

    .sub-tabs a, .team-tabs a, .role-tabs a {
      padding: 6px 18px;
      border-radius: 20px;
      background-color: #f1f1f1;
      color: #333;
      font-size: 14px;
      text-decoration: none;
      transition: all 0.2s;
    }

    .sub-tabs a.active, .team-tabs a.active, .role-tabs a.active {
      background-color: #c82e38;
      color: #fff;
    }

    .search-bar {
      display: flex;
      justify-content: flex-end;
      align-items: center;
      gap: 10px;
      margin-bottom: 20px;
    }

    .search-bar select, .search-bar input {
      border: 1px solid #ccc;
      padding: 7px 14px;
      border-radius: 25px;
      font-size: 14px;
    }

    .search-bar input {
      width: 200px;
    }

    .search-bar button {
      background-color: #444;
      color: white;
      padding: 7px 16px;
      border: none;
      border-radius: 25px;
      transition: all 0.2s;
    }

    .search-bar button:hover {
      background-color: #c82e38;
    }

    .write-btn {
      float: right;
      background-color: #444;
      color: white;
      border: none;
      padding: 7px 18px;
      border-radius: 25px;
      margin-bottom: 10px;
      transition: all 0.2s;
    }

    .write-btn:hover {
      background-color: #c82e38;
    }

    table.board-table {
      width: 100%;
      border-top: 2px solid #ccc;
      margin-bottom: 20px;
    }

    table.board-table th, table.board-table td {
      padding: 14px;
      text-align: center;
      font-size: 14px;
    }

    table.board-table th {
      background-color: #f9f9f9;
      font-weight: 600;
    }

    table.board-table td {
      border-bottom: 1px solid #eee;
    }

    .board-tag {
      display: inline-block;
      background-color: #b33939;
      color: #fff;
      font-size: 12px;
      padding: 3px 8px;
      border-radius: 12px;
      margin-right: 8px;
      vertical-align: middle;
    }

    .post-title {
	  color: #222;
	  font-weight: 600;
	  font-size: 16px;
	  text-decoration: none;
	  display: inline;        /* inlineìœ¼ë¡œ ë˜ëŒë¦¼ */
	}
	
	.post-title:hover {
	  color: #c82e38;
	  text-decoration: none;
	}

    .pagination {
      justify-content: center;
      margin-top: 20px;
    }

    .pagination li a {
      color: #333;
      background-color: #f1f1f1;
      border: 1px solid #ccc;
      margin: 0 3px;
      padding: 6px 12px;
      border-radius: 5px;
      transition: all 0.2s;
    }

    .pagination li.active a {
      background-color: #c82e38;
      border-color: #c82e38;
      color: #fff !important;
    }

    .team-tabs, .role-tabs {
      display: none;
    }

    .badge-icon {
	  width: 24px;
	  height: 24px;
	  margin-right: 0;
	  border-radius: 4px;
	  object-fit: cover;
	  border: 1px solid rgba(255, 255, 255, 0.4);
	  box-shadow: 0 0 6px rgba(255, 255, 255, 0.25);
	  background-color: #fff;
	  vertical-align: middle;
	}

    .nickname {
	  font-weight: 500;
	  background: linear-gradient(to right, #111, #444);
	  -webkit-background-clip: text;
	  -webkit-text-fill-color: transparent;
	  padding-left : 0;
	}
    
    .comment-count {
	  font-size: 14px;
	  font-weight: 600;
	  color: #c82e38;
	  margin-left: 4px;
	  vertical-align: baseline; /* âœ… ê¸°ì¤€ì„ ì— ë§ì¶¤ */
	  line-height: 1;
	  padding : 0;
	  margin-left : 1;
	}
		
	.board-table tbody tr:hover {
	  background-color: #fdf1f1;
	  transition: background-color 0.2s;
	}
	
	table.board-table tbody tr td {
	  border-bottom: 1px solid #ddd;
	}
	
	.new-label {
	  display: inline-block;
	  background-color: #f2dede;  /* ì€ì€í•œ ì—°ë¶„í™ ë°°ê²½ */
	  color: #a94442;             /* ê³ ê¸‰ìŠ¤ëŸ¬ìš´ ë‹¤í™ í…ìŠ¤íŠ¸ */
	  font-size: 11px;
	  font-weight: 600;
	  padding: 2px 6px;
	  margin-left: 6px;
	  border-radius: 8px;
	  vertical-align: middle;
	  border: 1px solid #ebcccc;
	}
	
	/* ê³ ì •ëœ ì¢‹ì•„ìš” Top ê²Œì‹œë¬¼ ìŠ¤íƒ€ì¼ */
	.top-liked-row {
	  background: linear-gradient(to right, #111, #222);
	  color: #fff;
	  font-weight: 600;
	  border-bottom: 1px solid #333 !important;
	}
	
	.top-liked-row .post-title {
	  color: #f1f1f1;
	}
	
	.top-liked-row .post-title:hover {
	  color: #f86a6a;
	}
	
	.top-liked-row .comment-count {
	  color: #ff8c8c;
	}
	
	.top-liked-row .new-label {
	  background-color: #2a2a2a;
	  color: #ff6666;
	  border-color: #444;
	}
	  </style>
</head>
<body>

  <div th:replace="common/header :: header"></div>

  <div class="board-wrapper">
    <div class="main-tabs mb-4" th:object="${filterMap}">
      <a th:href="@{/board/lounge}" th:class="*{type == null || type == '' || type.contains('lounge') ? 'active' : ''}">ë¼ìš´ì§€</a>
      <a th:href="@{/board/gallery}">ê°¤ëŸ¬ë¦¬</a>
      <a th:href="@{/board/video}">í•˜ì´ë¼ì´íŠ¸ ì˜ìƒ</a>
    </div>

    <div class="sub-tabs" th:object="${filterMap}">
      <a th:href="@{/board/lounge}" th:class="*{type == null || type == '' ? 'active' : ''}">ì „ì²´</a>
      <a th:href="@{/board/lounge(type='lounge_free')}" th:class="*{type == 'lounge_free' ? 'active' : ''}">ììœ </a>
      <a th:href="@{/board/lounge(type='lounge_play')}" th:class="*{type == 'lounge_play' ? 'active' : ''}">í”Œë ˆì´</a>
      <a th:href="@{/board/lounge(type='lounge_job')}" th:class="*{type != null and type.contains('lounge_job') ? 'active' : ''}">ì§ì—…</a>
    </div>

    <!-- ì§ì—… íƒ­ ì„ íƒ ì‹œ í‘œì‹œë  íŒ€ íƒ­ -->
    <div id="teamTabs" class="team-tabs" th:object="${filterMap}">
      <a th:href="@{/board/lounge(type='lounge_job')}" class="team-tab" data-team="all"
      th:classappend="*{type == 'lounge_job' ? ' active' : ''}">ì „ì²´</a>
      <a href="#" class="team-tab" data-team="mafia" id="team-mafia">íŒ€ ë§ˆí”¼ì•„</a>
      <a href="#" class="team-tab" data-team="citizen" id="team-citizen">íŒ€ ì‹œë¯¼</a>
      <a href="#" class="team-tab" data-team="third" id="team-third">íŒ€ ì œ3ì„¸ë ¥</a>
    </div>

    <!-- ê° íŒ€ë³„ ì§ì—… íƒ­ -->
    <div id="roleTabs-mafia" class="role-tabs" th:object="${filterMap}">
      <a th:href="@{/board/lounge(type='lounge_job_mafia')}" data-job="mafia" id="mafia"
      th:class="*{type == 'lounge_job_mafia' ? 'active' : ''}">ë§ˆí”¼ì•„</a>
    </div>

    <div id="roleTabs-citizen" class="role-tabs" th:object="${filterMap}">
      <a th:href="@{/board/lounge(type='lounge_job_police')}" data-job="police" id="police"
      th:class="*{type == 'lounge_job_police' ? 'active' : ''}">ê²½ì°°</a>
      <a th:href="@{/board/lounge(type='lounge_job_doctor')}" data-job="doctor" id="doctor"
      th:class="*{type == 'lounge_job_doctor' ? 'active' : ''}">ì˜ì‚¬</a>
      <a th:href="@{/board/lounge(type='lounge_job_spiritualist')}" data-job="spiritualist" id="spiritualist"
      th:class="*{type == 'lounge_job_spiritualist' ? 'active' : ''}">ì˜ë§¤ì‚¬</a>
    </div>

    <div id="roleTabs-third" class="role-tabs" th:object="${filterMap}">
      <a th:href="@{/board/lounge(type='lounge_job_disruptor')}" data-job="disruptor" id="disruptor"
      th:class="*{type == 'lounge_job_disruptor' ? 'active' : ''}">í›¼ë°©ê¾¼</a>
    </div>

    <!-- ê²€ìƒ‰ì°½ -->
    <form class="search-bar" method="get" th:action="@{/board/lounge}" th:object="${filterMap}">
      <select name="condition">
        <option value="title" th:selected="*{condition == 'title'}">ì œëª©</option>
        <option value="writer" th:selected="*{condition == 'writer'}">ì‘ì„±ì</option>
        <option value="content" th:selected="*{condition == 'content'}">ë‚´ìš©</option>
      </select>
      <input type="text" name="keyword" placeholder="ê²€ìƒ‰ì–´ ì…ë ¥" th:value="*{keyword}">
      <input type="hidden" name="type" th:value="*{type}">
      <button type="submit">ê²€ìƒ‰</button>
    </form>

    <!-- ê¸€ì“°ê¸° ë²„íŠ¼ -->
    <button class="write-btn" onclick="location.href='/board/lounge/write'">ê¸€ì“°ê¸°</button>
	
	
	
    <!-- ê²Œì‹œíŒ ë¦¬ìŠ¤íŠ¸ -->
    <table class="board-table">
      <thead>
        <tr>
          <th></th>
          <th style="text-align: left;">ì œëª©</th>
          <th style="text-align: left;">ì‘ì„±ì</th>
          <th style="text-align: left;">ë‚ ì§œ</th>
          <th style="text-align: left;">ì¡°íšŒìˆ˜</th>
        </tr>
      </thead>
      <!-- ê°œì„ ëœ ììœ ê²Œì‹œíŒ í…Œì´ë¸” ë¶€ë¶„ë§Œ ìˆ˜ì •í•œ ë²„ì „ -->
	  <tbody>
      <!-- ì¢‹ì•„ìš” ìˆœ Top 5 ê³ ì • ê²Œì‹œë¬¼ (ìŠ¤íƒ€ì¼ ë‹¤ë¦„) -->
	  <tr th:each="b : ${topLikedList}" class="top-liked-row">
	    <td><span class="board-tag" th:text="${b.displayName}"></span></td>
	    <td style="text-align: left;">
	      <a th:href="@{/board/lounge/detail/{boardNo}(boardNo=${b.boardNo})}"
	         class="post-title text-white font-weight-bold"
	         th:utext="${b.title + (b.replyCount > 0 ? ' <span class=''comment-count''>[' + b.replyCount + ']</span>' : '')}">
	      </a>
	      <span th:if="${b.isNew}" class="new-label">N</span>
	      <span th:if="${b.fileList[0].status == 'Y'}" style="margin-left: 4px;">ğŸ“</span>
	    </td>
	    <td style="text-align: left;">
	      <div style="display: flex; align-items: center; gap: 8px;">
	        <img th:if="${b.profileUrl != null}" th:src="${b.profileUrl}" class="badge-icon" />
	        <span class="nickname" th:text="${b.nickName}"></span>
	      </div>
	    </td>
	    <td th:text="${b.createDate}" style="text-align: left;"></td>
	    <td th:text="${b.viewCount}" style="text-align: left;"></td>
	  </tr>
	  
	  
      <tr th:if="${#lists.isEmpty(boardList)}">
        <td colspan="5">ì¡°íšŒëœ ê²Œì‹œë¬¼ì´ ì—†ìŠµë‹ˆë‹¤</td>
      </tr>
      <tr th:each="b : ${boardList}">
        <td>
          <span class="board-tag" th:text="${b.displayName}"></span>
        </td>
        <td style="text-align: left;">
		 <a th:href="@{/board/lounge/detail/{boardNo}(boardNo=${b.boardNo})}"
		   class="post-title"
		   th:utext="${b.title + (b.replyCount > 0 ? ' <span class=''comment-count''>[' + b.replyCount + ']</span>' : '')}">
		</a>
		<span th:if="${b.isNew}" class="new-label">N</span>
	    <span th:if="${b.fileList[0].status == 'Y'}" style="margin-left: 4px;padding-left: 0">ğŸ“</span>
		</td>
        <!-- ì‘ì„±ì ì¢Œì¸¡ ì •ë ¬ -->
		<td style="text-align: left;">
		  <div style="display: flex; align-items: center; gap: 8px;">
		    <img th:if="${b.profileUrl != null}" th:src="${b.profileUrl}" class="badge-icon" alt="ë±ƒì§€ ì´ë¯¸ì§€" />
		    <span class="nickname" th:text="${b.nickName}"></span>
		  </div>
		</td>
        <td style="text-align: left;" th:text="${b.createDate}"></td>
		<td style="text-align: left;" th:text="${b.viewCount}"></td>
      </tr>
    </tbody>
    </table>

    <!-- í˜ì´ì§€ë„¤ì´ì…˜ -->
    <ul class="pagination" th:if="${pi.endPage != 0}" th:object="${filterMap}">
      <li th:each="i : ${#numbers.sequence(pi.startPage,pi.endPage)}" th:classappend="${pi.currentPage == i ? ' active' : ''}" class="page-item">
        <a class="page-link" th:href="@{/board/lounge(currentPage=${i},type=*{type},condition=*{condition},keyword=*{keyword})}" th:text="${i}"></a>
      </li>
    </ul>
  </div>

  <div th:replace="common/footer :: footer"></div>

  <script>
    $(function () {
      // ì§ì—… íƒ­ì´ë©´ íŒ€ íƒ­ ë³´ì—¬ì¤Œ
      const currentUrl = window.location.href
      const isJobTabActive = currentUrl.includes("type=lounge_job");
      if (isJobTabActive) {
        $("#teamTabs").show();// ì „ì²´, íŒ€ ë§ˆí”¼ì•„, íŒ€ ì‹œë¯¼, íŒ€ ì œ 3ì„¸ë ¥ íƒ­ ë³´ì—¬ì£¼ê¸°
      }
      

      $(".sub-tabs a").on("click", function () { //ì „ì²´, ììœ , í”Œë ˆì´, ì§ì—… í´ë¦­ì‹œ
        if ($(this).attr("href").includes("lounge_job")) { // ì§ì—… í´ë¦­í–ˆë‹¤ë©´
          $("#teamTabs").fadeIn(200); //ì „ì²´, íŒ€ ë§ˆí”¼ì•„, íŒ€ ì‹œë¯¼, íŒ€ ì œ 3ì„¸ë ¥ ë‚˜ì˜¬ ìˆ˜ ìˆë„ë¡ (divì˜ì—­)
        } else {// ì „ì²´, ììœ , í”Œë ˆì´ í´ë¦­í–ˆë‹¤ë©´
          $("#teamTabs").fadeOut(200); //ì „ì²´, íŒ€ ë§ˆí”¼ì•„, íŒ€ ì‹œë¯¼, íŒ€ ì œ 3ì„¸ë ¥ ì‚¬ë¼ì§ˆ ìˆ˜ ìˆë„ë¡
          $(".role-tabs").hide(); //ë§ˆí”¼ì•„,ì‹œë¯¼,ê²½ì°°,ì˜ì‚¬ ë“± ì§ì—… íƒ­ ìˆ¨ê¸¸ ìˆ˜ ìˆë„ë¡
        }
      });

      $(".team-tab").on("click", function (e) { //ì „ì²´, íŒ€ ë§ˆí”¼ì•„, íŒ€ ì‹œë¯¼, íŒ€ ì œ 3ì„¸ë ¥ í´ë¦­í–ˆì„ì‹œ (aíƒœê·¸)
        //e.preventDefault(); //ì¼ë‹¨ ì´ë™ ë§‰ê¸°
        $(".team-tab").removeClass("active"); 
        $(this).addClass("active");  // ì „ì²´, íŒ€ ë§ˆí”¼ì•„, íŒ€ ì‹œë¯¼, íŒ€ ì œ 3ì„¸ë ¥ í´ë¦­í•œê²ƒë§Œ í™œì„±í™”ì‹œí‚¤ê¸°

        const team = $(this).data("team"); //ë§ˆí”¼ì•„ íŒ€ì¸ì§€, ì‹œë¯¼ íŒ€ì¸ì§€, ì œ3ì„¸ë ¥ íŒ€ì¸ì§€ ë¬¸ìì—´ ì¶œë ¥(all,mafia,citizen,third)
        $(".role-tabs").hide(); //ì§ì—… div ìˆ¨ê¸°ê¸°
        if (team === "mafia") $("#roleTabs-mafia").fadeIn(200); //ë§ˆí”¼ì•„ íŒ€ì´ë¼ë©´ ë§ˆí”¼ì•„ div ë‚˜ì˜¤ê²Œ í•˜ê¸°
        else if (team === "citizen") $("#roleTabs-citizen").fadeIn(200); //ì‹œë¯¼ íŒ€ì´ë¼ë©´ ì‹œë¯¼ div ë‚˜ì˜¤ê²Œ í•˜ê¸°
        else if (team === "third") $("#roleTabs-third").fadeIn(200); //ì œ 3ì„¸ë ¥ íŒ€ì´ë¼ë©´ ì œ 3ì„¸ë ¥ div ë‚˜ì˜¤ê²Œ í•˜ê¸°
      });
      
      $("#roleTabs-mafia a").each(function(index,el){ //ë§ˆí”¼ì•„ ì§ì—…êµ° ì„ íƒí–ˆìœ¼ë©´ íŒ€ ë§ˆí”¼ì•„ íƒ­ í™œì„±í™”ì‹œí‚¤ê¸°
    	  if($(el).attr('class') === 'active'){
			$("#team-mafia").click();    		  
    	  }
      });
      
      $("#roleTabs-citizen a").each(function(index,el){ //ì‹œë¯¼ ì§ì—…êµ° ì„ íƒí–ˆìœ¼ë©´ íŒ€ ë§ˆí”¼ì•„ íƒ­ í™œì„±í™”ì‹œí‚¤ê¸°
    	  if($(el).attr('class') === 'active'){
			$("#team-citizen").click();    		  
    	  }
      });
      
      $("#roleTabs-third a").each(function(index,el){ //ì œ3ì„¸ë ¥ ì§ì—…êµ° ì„ íƒí–ˆìœ¼ë©´ íŒ€ ë§ˆí”¼ì•„ íƒ­ í™œì„±í™”ì‹œí‚¤ê¸°
    	  if($(el).attr('class') === 'active'){
			$("#team-third").click();    		  
    	  }
      });

    });
  </script>
</body>
</html>
