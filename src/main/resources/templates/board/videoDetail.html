<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title th:text="'ì˜ìƒ | ' + ${video.title}">ì˜ìƒ ìƒì„¸</title>

<!-- Bootstrap + jQuery -->
<link rel="stylesheet"
	href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/css/bootstrap.min.css" />
<script
	src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>

<!-- Font Awesome -->
<link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

<!-- HLS.js -->
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>

<!-- ê³µí†µ CSS -->
<link rel="stylesheet" th:href="@{/css/common/header.css}" />
<link rel="stylesheet" th:href="@{/css/common/footer.css}" />
<link rel="stylesheet" th:href="@{/css/friend/friendList.css}" />
<link rel="stylesheet" th:href="@{/css/board/videoDetail.css}" />

</head>
<body>

	<!-- í—¤ë” -->
	<div th:replace="common/header :: header"></div>

	<div class="video-wrapper">
		<div class="video-card">

			<div class="video-title" th:utext="|<h2>${video.title}</h2>|">ì˜ìƒ
				ì œëª©</div>

			<div class="video-body">
				<div class="video-meta">
					<img th:if="${video.profileUrl}" th:src="${video.profileUrl}"
						alt="í”„ë¡œí•„" /> <span th:text="${video.nickName}">ë‹‰ë„¤ì„</span> <span
						th:text="${video.createDate}">2025.07.15</span> <span>ì¡°íšŒìˆ˜ <span
						th:text="${video.viewCount}">123</span></span> <span>â¤ <span
						th:text="${video.likeCount}">12</span></span>
				</div>

				<div class="video-player">
					<video id="video" controls></video>
				</div>

				<div class="video-description" th:utext="${video.detail}">ì˜ìƒì—
					ëŒ€í•œ ì„¤ëª…ì…ë‹ˆë‹¤. ì¬ë¯¸ìˆì—ˆë˜ í•˜ì´ë¼ì´íŠ¸ ì¥ë©´ì„ ì†Œê°œí•©ë‹ˆë‹¤.</div>

				<!-- âœ… ê²Œì‹œê¸€ ì¢‹ì•„ìš”/ì‹«ì–´ìš” ë²„íŠ¼: ë³¸ë¬¸ ë°”ë¡œ ì•„ë˜ì— ìœ„ì¹˜ -->
				<div
					class="post-like-dislike d-flex justify-content-center align-items-center"
					style="gap: 15px; margin: 30px 0;">
					<button id="btnLike" type="button"
						class="btn btn-outline-danger d-flex align-items-center"
						style="gap: 6px;">
						<i class="fas fa-heart"></i> ì¢‹ì•„ìš” <span id="likeCount"
							th:text="${video.likeCount}">0</span>
					</button>
					<button id="btnDislike" type="button"
						class="btn btn-outline-primary d-flex align-items-center"
						style="gap: 6px;">
						<i class="fas fa-thumbs-down"></i> ì‹«ì–´ìš” <span id="dislikeCount"
							th:text="${video.dislikeCount}">0</span>
					</button>
				</div>





				<div class="btn-group-custom">
					<a onclick="history.go(-1)" class="btn btn-custom btn-list">ëª©ë¡ìœ¼ë¡œ</a>
					<th:block th:if="${loginUser.userName == video.userName}">
						<a
							th:href="@{/board/video/update/{boardNo}(boardNo=${video.boardNo})}"
							class="btn btn-custom btn-update">ìˆ˜ì •</a>
					</th:block>
					<th:block th:if="${loginUser.userName == video.userName}">
						<form
							th:action="@{/board/video/delete/{boardNo}(boardNo=${video.boardNo})}"
							method="POST">
							<button class="btn btn-custom btn-delete"
								onclick="return confirm('ì •ë§ë¡œ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')">ì‚­ì œ</button>
						</form>
					</th:block>
				</div>

				<!-- ëŒ“ê¸€ ì‹œì‘ ì „ -->

				<!-- ëŒ“ê¸€ ì˜ì—­ -->
				<div class="comments-section">
					<hr />
					<!-- âœ… BEST ëŒ“ê¸€ ì˜ì—­ -->
					<div class="best-comments-section" style="margin-top: 40px;">
						<h6>ğŸ”¥ ë² ìŠ¤íŠ¸ ëŒ“ê¸€</h6>
						<div id="bestCommentList" class="comment-list"></div>
						<hr />
					</div>


					<h6>ğŸ’¬ ëŒ“ê¸€</h6>

					<!-- ëŒ“ê¸€ ëª©ë¡ -->
					<div id="commentList" class="comment-list">
						<!-- ë¹„ë™ê¸°ë¡œ ë¶ˆëŸ¬ì˜¨ ëŒ“ê¸€ì´ ì—¬ê¸°ì— ì‚½ì…ë  ì˜ˆì • -->
					</div>

					<!-- ëŒ“ê¸€ ì‘ì„± í¼ -->
					<div class="comment-form mt-3">
						<textarea class="form-control" id="commentContent" rows="3"
							placeholder="ëŒ“ê¸€ì„ ì…ë ¥í•˜ì„¸ìš”..."></textarea>
						<!-- ì´ë¯¸ì§€ íŒŒì¼ ì—…ë¡œë“œ ì¶”ê°€ -->
						<div class="mt-2">
							<input type="file" id="commentImage" accept="image/*"
								class="form-control-file text-light">
						</div>
						<img id="previewImage"
							style="max-width: 100px; margin-top: 10px; display: none;" />

						<div class="text-right mt-2">
							<button class="btn btn-primary btn-sm" id="submitComment">ë“±ë¡</button>
						</div>

					</div>
				</div>
			</div>

		</div>
	</div>

	<!-- í‘¸í„° -->
	<div th:replace="common/footer :: footer"></div>
	
	<script th:inline="javascript">
		const boardNo = /*[[${video.boardNo}]]*/ 0;
		const userName = /*[[${loginUser.userName}]]*/ '';
	</script>
	<script th:src="@{/js/board/comment.js}" th:inline="javascript"></script>
	<script th:src="@{/js/board/postLike.js}" th:inline="javascript"></script>
	
	<!-- HLS.js video ì¬ìƒ -->
	<script th:inline="javascript">
		$(function() {
			const video = document.getElementById('video');
			const videoSrc = '/godDaddy_uploadVideo/hls/'
					+ /*[[${#strings.replace(video.changeName, '.mp4', '.m3u8')}]]*/'';

			if (Hls.isSupported()) {
				const hls = new Hls();
				hls.loadSource(videoSrc);
				hls.attachMedia(video);
			} else if (video.canPlayType('application/vnd.apple.mpegurl')) {
				video.src = videoSrc;
			}

		});
	</script>
</body>
</html>
