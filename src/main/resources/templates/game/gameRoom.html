<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <link rel="stylesheet" th:href="@{/css/common/header.css}" />
    <link rel="stylesheet" th:href="@{/css/common/footer.css}" />
    <link rel="stylesheet" th:href="@{/css/chat/chat.css}" />
    <link rel="stylesheet" th:href="@{/css/index.css}" />
    <link rel="stylesheet" th:href="@{/css/job/playerPanel.css}" />
    <link rel="stylesheet" th:href="@{/css/game/phoneModal.css}" />
    <link rel="stylesheet" th:href="@{/css/friend/friendList.css}" />
    <title>ìš°ì£¼í•˜ë§ˆí”¼ì•„ ê²Œì„ë£¸</title>
    <style>
        #voiceRemoteContainer audio { display: block; margin: 4px 0; }
        .slot img.someNails:hover { transform: scale(1.05); filter: brightness(1.2); }
    </style>
</head>

<body>
    <div th:replace="~{common/header :: header}"></div>
    <div class="home-wrapper">
        <div class="sideAD"></div>
        <div th:replace="~{chat/gameMainChat :: gameMainChat}"></div>
        <div class="player-panel-container" style="position: relative;">
            <div id="controlPanel">
                <div th:replace="~{game/job/playerPanel :: playerPanelFragment}"></div>
                <div class="readyDiv" style="display: flex; align-items: center;">
                    <button class="startBtn" id="startBtn">Start</button>
                    <button class="readyBtn" id="readyBtn">Ready</button>
                    <div id="readyCount">Ready: 0</div>
                </div>
                <div id="gamePhaseContainer" class="game-phase">
                    <div id="dayCount">ì¼ì°¨ : 0</div>
                    <div id="killCount">íˆ¬í‘œ : 0</div>
                    <div id="phaseDisplay">í˜„ì¬ ë‹¨ê³„: -</div>
                    <div id="timerDisplay">ë‚¨ì€ ì‹œê°„: - ì´ˆ</div>
                    <button id="startVoiceBtn">ğŸ™ ìŒì„±ì±„íŒ… ì‹œì‘</button>
                    <button id="stopVoiceBtn" style="display:none;">ğŸ”‡ ìŒì„±ì±„íŒ… ì¢…ë£Œ</button>
                    <button id="muteVoiceBtn" style="display:none;"> ğŸ”ˆ </button>
                </div>
            </div>
            <div id="voiceRemoteContainer"></div>
            <div th:replace="~{game/phoneModal :: phoneModal}"></div>
            <button id="togglePhoneModalBtn" type="button" style="margin-top: 10px;">íœ´ëŒ€í° ì—´ê¸°</button>
        </div>
    </div>
    <div th:replace="~{common/footer :: footer}"></div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script th:src="@{/js/game/voiceChat.js}"></script>

    <!-- âœ¨ [í•µì‹¬ ìˆ˜ì •] ëª¨ë“  ì¸ë¼ì¸ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì œê±°í•˜ê³ , ì„¤ì • ê°ì²´ì™€ ë©”ì¸ ëª¨ë“ˆë§Œ ë‚¨ê¹€ -->
    <script th:inline="javascript">
        // ëª¨ë“ˆ ìŠ¤í¬ë¦½íŠ¸ì—ì„œ Thymeleaf ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ window ê°ì²´ì— ì„¤ì •
        window.MAFIA_GAME_CONFIG = {
            roomNo: /*[[${roomNo}]]*/ 0,
            nickName: /*[[${loginUser.nickName}]]*/ 'ìµëª…',
            userName: /*[[${loginUser.userName}]]*/ '',
            initialRoom: /*[[${room}]]*/ null
        };
    </script>
    
    <!-- ëª¨ë“ˆí™”ëœ ë©”ì¸ ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ. type="module"ì´ ì¤‘ìš”í•©ë‹ˆë‹¤. -->
    <script type="module" th:src="@{/js/game/main.js}"></script>
</body>
</html>